2018-11-26 11:00
使用scrapy 爬取赵大喜店铺所有照片，照片根据不同的类别分文件夹存储
其中xpath 与BeautifulSoup 混用
目标是一天半内爬完

2018-11-26 11:10
scrapy 开始内容：
    allowed_domains = ['zhaodaxi.taobao.com']
    # 这个url 是店铺里面“所有”的那个链接
    start_urls = ['https://zhaoyandaxi.taobao.com/search.htm?spm=a1z10.1-c-s.w15674828-14439897244.4.16786eabhYzh0p&scene=taobao_shop']

目标： 分析“详情页”的所有的数据，提取出下一页的链接，其中有的 有下一级菜单，有的没有
    上装： 衬衫，毛衣，卫衣等。
    裤装： 牛仔裤， 短裤
    配饰——女鞋： 没有下一级菜单

2018-11-26 14:30
提取数据遇到问题，所有分类的href 已经提取出来了，
进入到分类的网页后，再进入到某一个商品的详情页
这个详情页提取不出来，查看网页源代码，
源代码中也没有数据
现在卡在这里，需要分析一波

2018-11-26 15:10
通过F12查看，找出所需东西是ajax 请求，我记得崔大好像讲过这样的案例

2018-11-27 15:02
已经分析出ajax 请求的url 的关系，现在进行进一步提取
为了提取方便，把商品里面总的分类的链接去掉了，因为总的分类包含小的分类，
比如：连衣裙分类，下面包含：蕾丝连衣裙，雪纺连衣裙，无袖连衣裙等
这里把 连衣裙这个总的分类给删掉， 操作方法：
通过比较连衣裙和印花连衣裙的Url, 可以看出 总的分类的Url 较短
可以根据这一点过滤总分类的url


# 2018-11-27 16:00
已经提取出每个商品详细分类的id 现在分析它和ajax 请求的Url 的关系
除了商品分类的id 其他的都是一样的，时间戳也可以删掉

# 208-11-27 18:00
分类的Url提取出来了，分类里面每一个商品的id 通过正则也可以获取出来了
现在通过 https://zhaoyandaxi.taobao.com/category- + id
就可以访问所有的商品了，
现在的店小二又出现了， 准备用selenium 解决

# 2018-11-27 22:00
在给Url 加入时间戳之后，用selenium 每次打开都是提示要denglu
怀疑是没有加Headers

# 2018-11-28 10:25
网上查证，因为selenium 模拟拖动验证码时，速度太快，被检测为机器
通过分析人拖动浏览器的行为， 根据时间和速度的关系
分析出大致 函数曲线，导入numpy 库， 来使用类似的函数，
这样是滑动操作更像人一点

# 2018-11-28 16:00
函数什么的已经配置好了，但是滑动验证还是很难通过，
就是主要卡在这里了

# 2018-11-29 22:00
现在大致上有个思路:
move_by_offset(x, y) 将鼠标从x 坐标移动到y 的坐标
drag_and_drop(source , target) 按着鼠标左键在source 元素，移动到target 元素
所以模拟人的登录得用第二个。
现在的问题是： 模拟人拖动的时间-距离函数怎么写？
一个for 循环， 时间是均匀变换的，但是距离不是均匀变化的， 这个是得模拟人

# 2018-11-29 22:30
模拟滑动已经成功，但是速度太快，模拟人的思路是每次 滑动一点点
也就是将 滑动的距离x 暂时等分成10份，每次移动十分之一的距离
思路没错，问题是，selenium 模拟滑动的函数 drag_and_drop_by_offset(source)
source是每次要获取起始点的元素， 这样十分之一的慢慢的滑，起始点的元素怎么获取？

# 2018-11-30 16:48
模拟登录的函数终于明白了，它是原理是：
有一个函数， 这个函数的曲线 特别类似于 人拖动滑动条时的 时间与距离的函数关系曲线
现在用这样一个函数， 比如 y = 1 - pow(2, 10*x)  x 表示是时间， y 表示的距离
我们假如时间是10秒， 不过，用一个循环，一秒的距离，两秒的距离，三秒的距离....
然后用后一秒的距离减去前一秒的距离， 这就是我们每次移动的距离
把这个距离放到一个列表中，selenium 每次 拖动 鼠标移动的距离， 就是列表里面的距离

因为这个距离就是用一个类似人拖动滑动条的函数曲线 来得出的
所以每次移动的就是这个距离

参考的资料： http://www.aneasystone.com/archives/2018/03/python-selenium-geetest-crack.html

他的代码我改了很多，删了一些不必要的，同时 我是 后一次的距离 - 前一次的距离

目前的状态是能拖过去，但是还是验证不过，怀疑是距离分割的点太少，打算多分几个

# 2018-11-30 17:14
淘宝最恶心人的就是只要你模拟拖动一次，失败了， 后面手工拖都不行了